{
  "name": "express-graceful-exit",
  "version": "0.1.0",
  "description": "Allow express to support graceful exits to achieve zero downtime deploys",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/mathrawka/express-graceful-exit.git"
  },
  "homepage": "https://github.com/mathrawka/express-graceful-exit",
  "author": {
    "name": "Jon Keating",
    "email": "jon@licq.org"
  },
  "license": "MIT",
  "dependencies": {
    "underscore": "~1.4.4"
  },
  "readme": "# express-graceful-exit\n\nA component in having zero downtime deploys for Node.js with [Express](http://expressjs.com/). It was developed for Express 3.X, so it may need work to be compatible with Express 2.X\n\nThis module was developed for [Frafty](https://www.frafty.com/), a Daily Fantasy Sports site.\n\n## Installation\n\n```` bash\n$ cd /path/to/your/project\n$ npm install express-graceful-exit\n````\n\n## Usage\n\nThe following two components must be setup for this to work as planned.\n\n### Middleware\n\nThis middleware should be the very first middleware that gets setup with your Express app.\n\n```` javascript\nvar express = require('express')\n  , app = express()\n  , gracefulExit = require('express-graceful-exit')\n\napp.use(gracefulExit.middleware(app))\n````\n\n### Graceful Exit Handler\n\nThis function will cleanup the server and get it ready for shutting down. It can be attached to a signal, or used as a normal function call if another tool is used (such as [naught](https://github.com/indabamusic/naught)).\n\n```` javascript\n// Example for naught\nprocess.on('message', function(message) {\n  if (message === 'shutdown') {\n    gracefulExit.gracefulExitHandler(app, server {\n        socketio: app.settings.socketio\n    })\n  }\n})\n````\n\n## Options\n\n### Middleware\n\nThere are no options available currently.\n\n### Process Handler\n\nThe following options are available:\n\n* __log:__ Shows some messages about what is going on (default false).\n* __logger:__ Function that accepts a string to output a log message (default console.log).\n* __suicideTimeout:__ The timeout to forcefully exit the process with a return code of 1 (default 3 minutes).\n* __socketio:__ An instance of socket.io, that will close all open socket.io connections (default none)\n\n## Details\n\nTo gracefully exit this module will do the following things:\n\n1. Close the server so no new connections get accepted\n2. Mark that the server will gracefully exit, so if a connection that is using the Keep-Alive header is still active, it will be told to close the connection. The HTTP status code of 502 is returned, so nginx, ELB, etc will try again with a working server.\n3. If a socket.io instance is passed in the options, it enumerates all connected clients and disconnects them. The client should have code to reconnect on disconnect.\n5. Once all connected clients are disconnected, the server exits with an error code of 0.\n6. If there are still some remaining connections after the `suicideTimeout`, the server ungracefully exits with an error code of 1.\n\n## Getting zero downtime deploys\n\nThis module does not give you zero downtime deploys automatically, but provides a server that is capable of exiting gracefully, which can then be used by a module like naught to provide zero downtime deploys.\n\n#### Author: [Jon Keating](http://twitter.com/emostar)\n\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/mathrawka/express-graceful-exit/issues"
  },
  "_id": "express-graceful-exit@0.1.0",
  "dist": {
    "shasum": "810a64ca6eccfa5b1fcfa7a880a3e6bedf147ac8"
  },
  "_from": "express-graceful-exit@",
  "_resolved": "https://registry.npmjs.org/express-graceful-exit/-/express-graceful-exit-0.1.0.tgz"
}
